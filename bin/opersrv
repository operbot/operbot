#!/usr/bin/env python3
# This file is placed in the Public Domain.


import os
import readline
import signal
import sys
import termios
import time


sys.path.insert(0, os.getcwd())


from op import Wd, keys, printable, update
from oper import Client, Event, docmd, parse, scan, wait

from operbot import cmd, irc, rss
from operbot.irc import Config, IRC
from operbot.rss import Fetcher
from operbot.run import Cfg


Config.nick = "opersrv"
Config.channel = "#operbot"
Config.realname = "program your own commands"
Config.username = "opersrv"


Wd.workdir = os.path.expanduser("~/.operbot")


scan(cmd)
scan(irc)
scan(rss)


def hup(_sig, _frame):
    print("signal 15 called")
    sys.stdout.flush()


def main():
    signal.signal(signal.SIGHUP, hup)
    bot = IRC()
    bot.start()
    fetcher = Fetcher()
    fetcher.start()
    wait()
        

main()
